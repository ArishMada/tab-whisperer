function i(e){return e?e.startsWith("chrome://")||e.startsWith("edge://")||e.startsWith("about://"):!1}chrome.action.onClicked.addListener(async e=>{if(e.id){if(i(e.url)){await chrome.windows.create({url:chrome.runtime.getURL("sidebar.html"),type:"popup",width:420,height:700});return}try{await chrome.tabs.sendMessage(e.id,{type:"TOGGLE_SIDEBAR"})}catch{try{await chrome.scripting.executeScript({target:{tabId:e.id},files:["content.js"]}),await chrome.tabs.sendMessage(e.id,{type:"TOGGLE_SIDEBAR"})}catch{await chrome.windows.create({url:chrome.runtime.getURL("sidebar.html"),type:"popup",width:420,height:700})}}}});chrome.runtime.onMessage.addListener(async(e,a,r)=>{if(e?.type==="CLOSE_SIDEBAR"){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t?.id)try{await chrome.tabs.sendMessage(t.id,{type:"TOGGLE_SIDEBAR"})}catch{}return r?.({ok:!0}),!0}});
